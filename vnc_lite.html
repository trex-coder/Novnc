<!DOCTYPE html>
<html lang="en">
<head>
    <title>noVNC Fullscreen</title>
    <style>
        html, body {
            margin: 0;
            height: 100%;
            background-color: black;
        }
        #screen {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
    </style>

    <script type="module" crossorigin="anonymous">
        import RFB from './core/rfb.js';

        let rfb;

        function readQueryVariable(name, defaultValue) {
            const re = new RegExp('.*[?&]' + name + '=([^&#]*)');
            const match = document.location.href.match(re);
            return match ? decodeURIComponent(match[1]) : defaultValue;
        }

        async function goFullscreen() {
            const screenElem = document.documentElement;
            if (screenElem.requestFullscreen) {
                await screenElem.requestFullscreen();
            } else if (screenElem.webkitRequestFullscreen) {
                await screenElem.webkitRequestFullscreen();
            } else if (screenElem.msRequestFullscreen) {
                await screenElem.msRequestFullscreen();
            }
        }

        window.addEventListener('load', async () => {
            await goFullscreen();

            const host = readQueryVariable('host', window.location.hostname);
            const port = readQueryVariable('port', window.location.port);
            const password = readQueryVariable('password');
            const path = readQueryVariable('path', 'websockify');

            let url = (window.location.protocol === "https:" ? "wss://" : "ws://") + host;
            if (port) url += ':' + port;
            url += '/' + path;

            rfb = new RFB(document.getElementById('screen'), url, {
                credentials: { password: password }
            });

            rfb.viewOnly = readQueryVariable('view_only', false);
            rfb.scaleViewport = readQueryVariable('scale', false);
        });
    </script>
</head>
<body>
    <div id="screen"></div>
</body>
</html>
